<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Upload file</title>
        <script type="text/javascript" src="js/jquery-3.4.1.min.js"></script>
        <script type="text/javascript">
            $(document).ready(function() {
                $("#search").click(
                  function() {
                    $.get('/get_meta_data', {
                        title: $("#title").val(), 
                        author: $("#author").val(),
                        isbn: $("#isbn").val(),
                    }, function(resultString, textStatus, jqXHR) {
                        $("#searchForm").addClass("hidden");
                        var results = jQuery.parseJSON(resultString);
                        resultsContainer = $("#searchResults");
                        results.forEach(function(book) {
                            entry = $("<div><span style=\"font-style: italic\">" + book.title + "</span>, " + book.authors + " </div>");
                            button = $("<button />", {
                                text: "Add to database",
                                click: function() {
                                    $.post("/new_entry", book, function(result) {
                                        console.log(result);
                                        $("#searchForm").removeClass("hidden");
                                        $("#searchResults").empty();
                                    });
                                }
                            })
                            resultsContainer.append(entry);
                            entry.append(button);
                        })
                    });
                });
                });
        </script>
    </head>
    <body>
        <div id="searchForm">
            <h1>New Entry</h1>
            <form method="post">
                <label for="title">Title:</label>
                <input id="title" type="text" name="title" label="Title">
                <br>
                <label for="author">Author:</label>
                <input id="author" type="text" label="Author" name="author">
                <br>
                <label for="isbn">ISBN:</label>
                <input id='isbn' type="text" label="ISBN" name="isbn">
                <br>
                <input id='publisher' type='hidden' name=publisher>
                <input id='publishedDate' type='hidden' name=publisher>
                <br>
                <input type='submit' id="timetosubmitthisbitch" value='add entry'>
            </form>
            <br>
            <button id="search">Search</button>
        </div>
        <div id="searchResults">
            
        </div>
    </body>
</html>
